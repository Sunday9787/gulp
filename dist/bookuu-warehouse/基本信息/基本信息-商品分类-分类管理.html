<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" type="text/css" href="../css/reset.css">
  <link rel="stylesheet" type="text/css" href="../css/iconfont.css">
  <link rel="stylesheet" type="text/css" href="../css/base.css">
  <link rel="stylesheet" type="text/css" href="../css/module.css">
  <link rel="stylesheet" type="text/css" href="../css/component.css">
  <script src="../js/jquery-1.10.2.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/compontent.js" type="text/javascript" charset="utf-8"></script>
  <!--[if lte IE 8]><script src="../lib/html5.js" type="text/javascript" charset="utf-8">
    </script> <script src="../lib/respond.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../lib/css3-mediaqueries.min.js" type="text/javascript" charset="utf-8"></script><![endif]-->
  <title>仓库管理-库存管理-库存查询</title>
</head>

<body>
  <div class="main clearfix">
    <!-- 头部导航 -->
    <nav class="navbar clearfix">
      <div class="navbar-header">仓储管理系统</div>
      <ul class="mainbav">
        <li class="item">
          <a href="javascript:;">订单管理</a>
        </li>
        <li class="item">
          <a href="javascript:;">仓库管理</a>
        </li>
        <li class="item">
          <a href="javascript:;">统计报表</a>
        </li>
        <li class="item active">
          <a href="javascript:;">基本信息</a>
        </li>
        <li class="clear"></li>
      </ul>
      <div class="nav-user dropdown">
        <a class="dropdown-toggle" data-type="click" role="button" href="javascript:;">神机网络</a>
        <ul class="dropdown-menu">
          <li class="item">
            <a href="javascript:;">帮助中心</a>
          </li>
          <li class="item">
            <a href="javascript:;">退出登陆</a>
          </li>
        </ul>
        <div class="clear"></div>
      </div>
      <div class="clear"></div>
    </nav>
    <!-- 侧边栏菜单 -->
    <div class="sidebar-left">
      <menu>
        <ul class="sidebar-left-menu">
          <li class="item active">
            <div class="pd-2008">
              <a href="javascript:;">
                <div class="fl"><span class="icon">&#xe60a;</span>&nbsp;账户管理&nbsp;</div>
                <div class="fr"><span class="icon-arrow-right">&#xe60e;</span></div>
                <div class="clear"></div>
              </a>
            </div>
            <ul class="list-item">
              <li class="item active">
                <a href="javascript:;">用户管理</a>
              </li>
              <li class="item">
                <a href="javascript:;">角色管理</a>
              </li>
            </ul>
          </li>
          <li class="item">
            <div class="pd-2008">
              <a href="javascript:;">
                <div class="fl"><span class="icon">&#xe614;</span>&nbsp;商品分类&nbsp;</div>
                <div class="fr"><span class="icon-arrow-right">&#xe60f;</span></div>
                <div class="clear"></div>
              </a>
            </div>
            <ul class="list-item">
              <li class="item">
                <a href="javascript:;">退货查询</a>
              </li>
            </ul>
          </li>
          <li class="item">
            <div class="pd-2008">
              <a href="javascript:;">
                <div class="fl"><span class="icon">&#xe610;</span>&nbsp;仓库架位&nbsp;</div>
                <div class="fr"><span class="icon-arrow-right">&#xe60f;</span></div>
                <div class="clear"></div>
              </a>
            </div>
            <ul class="list-item">
              <li class="item">
                <a href="javascript:;">仓库列表</a>
              </li>
              <li class="item active">
                <a href="javascript:;">仓区列表</a>
              </li>
              <li class="item">
                <a href="javascript:;">架位列表</a>
              </li>
            </ul>
          </li>
          <li class="item">
            <div class="pd-2008">
              <a href="javascript:;">
                <div class="fl"><span class="icon">&#xe609;</span>&nbsp;供应商管理&nbsp;</div>
                <div class="fr"><span class="icon-arrow-right">&#xe60f;</span></div>
                <div class="clear"></div>
              </a>
            </div>
            <ul class="list-item">
              <li class="item">
                <a href="javascript:;">供应商管理</a>
              </li>
            </ul>
          </li>
        </ul>
      </menu>
      <div class="clear"></div>
    </div>
    <div class="wrapper">
      <h3 class="content-title">分类管理</h3>
      <div class="content">
        <p><a id="make_dir" href="javascript:;" class="btn">+新增</a></p>
        <div class="search mt-10">
          <input id="search" type="text" placeholder="请输入您要搜索的分类内容"><a class="search-btn" href="javascript:;"><span class="icon cl-bl">&#xe61b;</span>&nbsp;搜索</a>
        </div>
        <aside class="mt-20 wd-60p">
          <ul class="class-manager">
            <li class="item">
              <div class="class-name class-layer-name" data-layer="图书" data-name="图书" data-type="dir">
                <div class="fl">
                  <a class="name cl-9" href="javascript:;">&nbsp;<span class="name">图书</span></a>
                </div>
                <div class="fl">
                  <a class="cl-bl mg-0010 modify" href="javascript:;">修改</a><a class="cl-bl mg-0010 add" href="javascript:;">新增</a><a class="cl-bl mg-0010 del" href="javascript:;">删除</a>
                </div>
                <div class="fr"><a class="icon" href="javascript:;"><span class="icon-arrow-right">&#xe60f;</span></a></div>
                <div class="clear"></div>
              </div>
              <ul class="class-layer class-layer-child">
                <li class="item">
                  <div class="class-layer-name" data-layer="图书-少儿" data-name="少儿" data-type="dir">
                    <div class="fl">
                      <a class="name cl-9" href="javascript:;">
                        <span class="icon-triangle-bottom" style="font-size:14px;">&#xe61a;</span>&nbsp;<span class="name">少儿</span>
                      </a>
                    </div>
                    <div class="fl operat hidden">
                      <a class="cl-bl mg-0010 modify" href="javascript:;">修改</a><a class="cl-bl mg-0010 add" href="javascript:;">新增</a><a class="cl-bl mg-0010 del" href="javascript:;">删除</a>
                    </div>
                    <div class="clear"></div>
                  </div>
                  <ul class="class-layer-child" style="display:none;">
                    <li class="item">
                      <div class="class-layer-name" data-layer="图书-少儿-文化" data-name="文化" data-type="dir-item">
                        <div class="fl">
                          <a class="name cl-9" href="javascript:;">
                            <span class="icon-triangle-bottom" style="font-size:14px;">&#xe61a;</span>&nbsp;<span class="name">文化</span>
                          </a>
                        </div>
                        <div class="fl operat hidden">
                          <a class="cl-bl mg-0010 modify" href="javascript:;">修改</a><a class="cl-bl mg-0010 add" href="javascript:;">新增</a><a class="cl-bl mg-0010 del" href="javascript:;">删除</a>
                        </div>
                        <div class="clear"></div>
                      </div>
                      <ul class="class-layer-child" style="display:none;">
                        <li class="item">
                          <div class="class-layer-child-name" data-name="百科全书">
                            <div class="fl name"><a class="name" href="javascript:;"><span class="name">百科全书</span></a></div>
                            <div class="fl operat hidden">
                              <a class="cl-bl mg-0010 modify" href="javascript:;">修改</a><a class="cl-bl mg-0010 del" href="javascript:;">删除</a>
                            </div>
                            <div class="clear"></div>
                          </div>
                        </li>
                        <li class="item">
                          <div class="class-layer-child-name" data-name="人文地理">
                            <div class="fl">
                              <a href="javascript:;"><span class="name">人文地理</span></a>
                            </div>
                            <div class="fl operat hidden">
                              <a class="cl-bl mg-0010 modify" href="javascript:;">修改</a><a class="cl-bl mg-0010 del" href="javascript:;">删除</a>
                            </div>
                            <div class="clear"></div>
                          </div>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </aside>
      </div>
    </div>
    <div class="clear"></div>
  </div>
  <!-- 搜索 -->

  <!-- <div id="prop-box" style="display:block;opacity: 1;top:50%;left:60%;">
    <h4 class="prop-title clearfix">
      <div class="prop-title-text fl">为您搜索到如下结果</div>
      <div class="fr">
        <a class="prop-icon-close icon" href="javascript:;">&#xe611;</a>
      </div>
      <div class="clear"></div>
    </h4>
    <div class="prop-content">
      <div style="height:300px;width:450px;">
        <ul>
          <li class="lh-32">
            <a href="javascript:;">图书</a>&nbsp;&gt;&nbsp;<a class="cl-bl" href="javascript:;">人文</a>&nbsp;&gt;&nbsp;<a href="javascript:;">社科</a>
          </li>
          <li class="lh-32">
            <a href="javascript:;">图书</a>&nbsp;&gt;&nbsp;<a class="cl-bl" href="javascript:;">人文</a>&nbsp;&gt;&nbsp;<a href="javascript:;">社科</a>
          </li>
          <li class="lh-32">
            <a href="javascript:;">图书</a>&nbsp;&gt;&nbsp;<a class="cl-bl" href="javascript:;">人文</a>&nbsp;&gt;&nbsp;<a href="javascript:;">社科</a>
          </li>
        </ul>
      </div>
    </div>
  </div> -->

  <!-- 分类 -->
  <!-- <div id="prop-box" style="display:block;opacity: 1;top:50%;">
    <h4 class="prop-title clearfix">
      <div class="prop-title-text fl">新增分类</div>
      <div class="fr">
        <a class="prop-icon-close icon" href="javascript:;">&#xe611;</a>
      </div>
      <div class="clear"></div>
    </h4>
    <div class="prop-content">
      <form class="prop-box-from" action="javascript:;" method="post">
        <table class="lh-30">
          <tbody>
            <tr>
              <td class="ta-rt">
                <dfn>父级分类：</dfn>
              </td>
              <td>
                <select class="ml-10" name="" style="width:150px;">
                  <option value="">图书—少儿</option>
                  <option value="">图书—少儿</option>
                  <option value="">图书—少儿</option>
                </select>
              </td>
            </tr>
            <tr>
              <td class="ta-rt">
                <dfn>分类名称：</dfn>
              </td>
              <td>
                  <input class="ml-10" type="text" name="" value="" style="width:150px;">
              </td>
            </tr>
            <tr>
              <td class="ta-rt">
                <dfn>是否可用：</dfn>
              </td>
              <td>
                <select class="ml-10" name="" style="width:150px;">
                  <option value="">是</option>
                  <option value="">否</option>
                </select>
              </td>
            </tr>
          </tbody>
        </table>
      </form>
    </div>
    <div class="prop-btn ta-ct">
      <a href="javascript:;" class="prop-btn-true btn">确定</a>
      <a href="javascript:;" class="prop-btn-false btn muted">取消</a>
    </div>
  </div> -->
</body>
<script src="../js/global.js" charset="utf-8"></script>
<script type="text/javascript">
var J_SearchTempalte = {
  'propupTitle':'为您搜索到如下结果',
  'propupContent':'<div style="height:300px;min-height:300px;width:450px;overflow:auto;">'+
    '<ul>'+
      '<li class="lh-32">'+
        '<a href="javascript:;">图书</a>&nbsp;&gt;&nbsp;<a class="cl-bl" href="javascript:;">人文</a>&nbsp;&gt;&nbsp;<a href="javascript:;">社科</a>'+
      '</li>'+
      '<li class="lh-32">'+
        '<a href="javascript:;">图书</a>&nbsp;&gt;&nbsp;<a class="cl-bl" href="javascript:;">人文</a>&nbsp;&gt;&nbsp;<a href="javascript:;">社科</a>'+
      '</li>'+
      '<li class="lh-32">'+
        '<a href="javascript:;">图书</a>&nbsp;&gt;&nbsp;<a class="cl-bl" href="javascript:;">人文</a>&nbsp;&gt;&nbsp;<a href="javascript:;">社科</a>'+
      '</li>'+
    '</ul>'+
  '</div>'
}
$('.search').on('click','.search-btn',function(e){
  PropUpAlert({
    'propupContent': J_SearchTempalte['propupContent'],
    'propupTitle': J_SearchTempalte['propupTitle']
  },function(){

  }, function (result) {
    /* 返回布尔值 */
    console.log(result)
  })

  e.stopPropagation()
})

/*
 * 判断项目类型
 * @dir 目录
 * @dir-item 子列表目录
 *
 * @&#xe60c; 实心三角向下 代表 当前展开
 * @&#xe61a; 实心三角向右 代表 当前伸缩
 * @默认展开隐藏 请手动设置 style="display: block;"  style="display: none;"
 */

  // 主类名 展开伸缩
  $('.class-manager').on('click','.class-name,.name',function(e){
    $(this).next('.class-layer').slideToggle(400,function(){
      if($(this).is(':visible')){
        $(this).prev('.class-name').find('.icon-arrow-right').html('&#xe60e;')
      } else {
        $(this).prev('.class-name').find('.icon-arrow-right').html('&#xe60f;')
      }
    })
    e.stopPropagation();
  })

  // 显示隐藏 操作
  $('.class-manager').on(
    {
      'mouseover': function(){
      $(this).find('.operat').removeClass('hidden')
    },
    'mouseout':function (){
      $(this).find('.operat').addClass('hidden')
    }
  },'.item>div')

  // 子级类名展开伸缩
  $('.class-manager').on('click','.class-layer-name .name , .class-layer-name .icon',function(e){
    // console.log(this)
    var _this = this;
    $(this).parents('.class-layer-name').next('.class-layer-child').slideToggle(400,function(){
      if($(this).is(':visible')) {
        $(_this).find('.icon-triangle-bottom').html('&#xe60c;')
      } else {
        $(_this).find('.icon-triangle-bottom').html('&#xe61a;')
        // $(this).find('.class-layer-child-name span').html('&#xe61a;')
        // $(this).find('.class-layer-child').slideUp(400)
      }
    })
    e.stopPropagation();
  })


  // make_dir 新增主目录
  $('#make_dir').on('click',function(e){
    var addTempalte = {
      'propupTitle': '新增分类',
      'propupContent': '<form class="prop-box-from" action="javascript:;" method="post">'+
        '<table class="lh-30">'+
          '<tbody>'+
            '<tr>'+
              '<td class="ta-rt">'+
                '<dfn>父级分类：顶级</dfn>'+
              '</td>'+
              '<td>'+
                '<span class="ml-10">&nbsp;</span>'+
              '</td>'+
            '</tr>'+
            '<tr>'+
              '<td class="ta-rt">'+
                '<dfn>分类名称：</dfn>'+
              '</td>'+
              '<td>'+
                  '<input class="ml-10" type="text" name="class-layer-name" value="" style="width:150px;">'+
              '</td>'+
            '</tr>'+
            '<tr>'+
              '<td class="ta-rt">'+
                '<dfn>是否可用：</dfn>'+
              '</td>'+
              '<td>'+
                '<select class="ml-10" name="select" style="width:150px;">'+
                  '<option value="是">是</option>'+
                  '<option value="否">否</option>'+
                '</select>'+
              '</td>'+
            '</tr>'+
          '</tbody>'+
        '</table>'+
      '</form>'
    }
    PropUp({
      'propupContent': addTempalte['propupContent'],
      'propupTitle': addTempalte['propupTitle']
    }, function () {
      //
    }, function (result) {
      /* 返回布尔值 */
      // console.log(result);
      // 推荐用 .serializeArray() 方法获得表单元素
      if(!result) return;

      var x = $('.prop-box-from').serializeArray();
      $.each(x,function(index, field) {
        console.log(field.name + ':' + field.value)
      })

      var make_dirTemplate = '<li class="item">'+
        '<div class="class-name class-layer-name" data-layer="'+ x[0].value +'" data-name="'+ x[0].value +'" data-type="dir">'+
          '<div class="fl">'+
            '<a class="name cl-9" href="javascript:;">&nbsp;<span class="name">'+ x[0].value +'</span></a>'+
          '</div>'+
          '<div class="fl">'+
            '<a class="cl-bl mg-0010 modify" href="javascript:;">修改</a><a class="cl-bl mg-0010 add" href="javascript:;">新增</a><a class="cl-bl mg-0010 del" href="javascript:;">删除</a>'+
          '</div>'+
          '<div class="fr"><a class="icon" href="javascript:;"><span class="icon-arrow-right">&#xe60f;</span></a></div>'+
          '<div class="clear"></div>'+
        '</div>'+
        '<ul class="class-layer class-layer-child"></ul>'+
      '</li>';
      $('.class-manager').append(make_dirTemplate)
  })
  e.stopPropagation();
  })


  // 修改
  $('.class-manager').on('click','.class-layer-name .modify,.class-layer-child-name .modify',function(e){
    /*
     * layerNameEl 点击元素所对应的 分类名称
     * 如果不在后面加[0]索引  jQuery始终是会返回一个数组对象 逻辑或 当地一个返回为真的时候 是不会进行下一个运算 返回的第一个下标就是 HTML元素
     */
    var layerNameEl = $(this).parents('.class-layer-name')[0] || $(this).parents('.class-layer-child-name')[0];
    var addTempalte = {
      'propupTitle': '修改分类',
      'propupContent': '<form class="prop-box-from" action="javascript:;" method="post">'+
        '<table class="lh-30">'+
          '<tbody>'+
            '<tr>'+
              '<td class="ta-rt">'+
                '<dfn>新名称：</dfn>'+
              '</td>'+
              '<td>'+
                  '<input class="ml-10" type="text" name="class-layer-name" value="'+ $(layerNameEl).data('name') +'" style="width:150px;">'+
              '</td>'+
            '</tr>'+
            '<tr>'+
              '<td class="ta-rt">'+
                '<dfn>是否可用：</dfn>'+
              '</td>'+
              '<td>'+
                '<select class="ml-10" name="select" style="width:150px;">'+
                  '<option value="是">是</option>'+
                  '<option value="否">否</option>'+
                '</select>'+
              '</td>'+
            '</tr>'+
          '</tbody>'+
        '</table>'+
      '</form>'
    }
    PropUp({
      'propupContent': addTempalte['propupContent'],
      'propupTitle': addTempalte['propupTitle']
    }, function () {
      //
    }, function (result) {
      /* 返回布尔值 */
      // console.log(result);
      // 推荐用 .serializeArray() 方法获得表单值
      if(!result) return;

      var x = $('.prop-box-from').serializeArray();
      $.each(x,function(index, field) {
        console.log(field.name + ':' + field.value)
      });
      $(layerNameEl).attr('data-name',x[0].value).attr('data-layer',x[0].value).find('span.name').text(x[0].value)
      // console.log(layerNameEl)
      // console.log(x,x[0].value)
    })
    e.stopPropagation();
  })


  // 添加
  $('.class-manager').on('click','.class-layer-name .add',function(e){
    // console.log(this)
    var _this = this;
    var layerName = $(this).parents('.class-layer-name').data('layer');
    var addTempalte = {
      'propupTitle': '新增分类',
      'propupContent': '<form class="prop-box-from" action="javascript:;" method="post">'+
        '<table class="lh-30">'+
          '<tbody>'+
            '<tr>'+
              '<td class="ta-rt">'+
                '<dfn>父级分类：</dfn>'+
              '</td>'+
              '<td>'+
                '<span class="ml-10">'+ layerName +'&nbsp;-</span>'+
              '</td>'+
            '</tr>'+
            '<tr>'+
              '<td class="ta-rt">'+
                '<dfn>分类名称：</dfn>'+
              '</td>'+
              '<td>'+
                  '<input class="ml-10" type="text" name="class-layer-name" value="" style="width:150px;">'+
              '</td>'+
            '</tr>'+
            '<tr>'+
              '<td class="ta-rt">'+
                '<dfn>是否可用：</dfn>'+
              '</td>'+
              '<td>'+
                '<select class="ml-10" name="select" style="width:150px;">'+
                  '<option value="是">是</option>'+
                  '<option value="否">否</option>'+
                '</select>'+
              '</td>'+
            '</tr>'+
          '</tbody>'+
        '</table>'+
      '</form>'
    }
    PropUp({
      'propupContent': addTempalte['propupContent'],
      'propupTitle': addTempalte['propupTitle']
    }, function () {
      //
    }, function (result) {
      /* 返回布尔值 */
      // console.log(result);
      // 推荐用 .serializeArray() 方法获得表单元素
      if(!result) return;

      var x = $('.prop-box-from').serializeArray();
      $.each(x,function(index, field) {
        console.log(field.name + ':' + field.value)
      });
      // console.log(x)

      /*
      ********************重要！********************
      * dirType 层级类型  dir.length  直接关于到层级高度
      *
      * data-layer="图书-少儿-文化" data-name="文化" data-type="dir-item"
      * 层级判断根据 data('layer').split('-')
      * dir.length < 2
      */

      var dir = $(_this).parents('.class-layer-name').data('layer').split('-');
      var dirType ='';
      dir.length < 2 ? dirType = 'dir' : dirType = 'dir-item';
      console.log(dir,dirType)
      // console.log(dir)
      // return;
      var layerClass = '<li class="item">'+
        '<div class="class-layer-name" data-layer="'+ $(_this).parents('.class-layer-name').data('layer') + '-' + x[0].value +'"data-name="'+ x[0].value +'" data-type="'+ dirType +'">'+
          '<div class="fl">'+
            '<a class="name cl-9" href="javascript:;">'+
              '<span class="icon-triangle-bottom" style="font-size:14px;">&#xe61a;</span>&nbsp;<span class="name">'+ x[0].value +'</span>'+
            '</a>'+
          '</div>'+
          '<div class="fl operat hidden">'+
            '<a class="cl-bl mg-0010 modify" href="javascript:;">修改</a><a class="cl-bl mg-0010 add" href="javascript:;">新增</a><a class="cl-bl mg-0010 del" href="javascript:;">删除</a>'+
          '</div>'+
          '<div class="clear"></div>'+
        '</div>'+
        '<ul class="class-layer-child" style="display: none;">'+
        '</ul>'+
      '</li>';
      //
      var layerItem = '<li class="item">'+
        '<div class="class-layer-child-name" data-name="'+ x[0].value +'">'+
          '<div class="fl"><a href="javascript:;"><span class="name">'+ x[0].value +'</span></a></div>'+
          '<div class="fl operat hidden">'+
            '<a class="cl-bl mg-0010 modify" href="javascript:;">修改</a><a class="cl-bl mg-0010 del" href="javascript:;">删除</a>'+
          '</div>'+
          '<div class="clear"></div>'+
        '</div>'+
      '</li>';

      /*
       * 判断新增项目类型
       */

      if($(_this).parents('.class-layer-name').data('type') === 'dir') {
        $(_this).parents('.class-layer-name').next('.class-layer-child').append(layerClass);
      } else {
        $(_this).parents('.class-layer-name').next('.class-layer-child').append(layerItem);
      }
    })
    e.stopPropagation();
  })

  // 删除
  // .class-layer-name .del  主目录删除按钮
  // .class-layer-child-name .del 子目录和子级 删除按钮
  $('.class-manager').on('click','.class-layer-name .del,.class-layer-child-name .del',function(e){
    var _this = this;
    // console.log(this)
    var delTempalte = {
      'propupContent': '<p class="ta-ct">确认删除？</p>',
      'propupTitle': '确认'
    }
    PropUp({
      'propupContent': delTempalte['propupContent'],
      'propupTitle': delTempalte['propupTitle']
    }, function () {
      //
    }, function (result) {
      /* 返回布尔值 */
      // console.log(result);
      if(!result) return;
      // console.log($(_this).parents('.class-layer-name').next('ul').children().length);

      //判断删除类型
     if ($(_this).parents('.class-layer-name').data('type') === 'dir' || $(_this).parents('.class-layer-name').data('type') === 'dir-item') {
       if($(_this).parents('.class-layer-name').next('ul').children().length > 0) {
         alert('当前目录下有子类不可删除!')
         return;
       } else {
         $(_this).parents('.class-layer-name').parent('.item').remove()
       }
     } else {
        $(_this).parents('.class-layer-child-name').parent('.item').remove()
     }
    })
    e.stopPropagation();
  })
</script>
</html>
